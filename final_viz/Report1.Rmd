---
title: "Report1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## (1) Introduction


## (2) Description of data

- Linkage data was collected from INS website
- INS website is very slow
- Planet didn’t provide large enough coverage eg. at the country level
- Many sources for satellite imagery


## (3) Analysis of data quality

Some of the variable names are unclear, probably due to shoddy translation (i.e. what is the diff between ‘Number of households having drinking water from the public source or source of water association’ and ‘Number of households having drinking water from the other public or private source’?

## (4) Main analysis (Exploratory Data Analysis)

Extensive data processing

### (4.a) Consumption by Governorates
```{r}
consumption2015 <- readxl::read_xlsx("../data/intermediate/Enquête Consommation 2010 12_08_2018 10_49_06.xlsx")

names(consumption2015) <- consumption2015[1,] #copy 1st row
consumption2015 <- consumption2015[-1,] #remove 1st row from df
tbl_df(consumption2015) 

names(consumption2015)[1]<-"categories"

totalConsump15 <- filter(consumption2015, consumption2015$categories == "Total")
tidyConsump15 <- gather(totalConsump15, key="Governorates", value="Consumption")
tidyConsump15 <- tidyConsump15[-1,]
#tidyConsump15 <- filter(tidyConsump15, tidyConsump15$Governorates == "Total")

#removing Greater regions
tidyConsump15 <- filter(tidyConsump15, !Governorates %in% c("Great Tunis", "Governorate of Ariana", "North East", "North West","Par grandes régions\\Centre Est","Par grandes régions\\Centre Ouest","Par grandes régions\\Sud Est","Par grandes régions\\Sud Ouest"))

#Note: Choroplethr does not include the governorate, "Governorate of Ariana" 

#Rename governorate to match the ChoroplethrAdmin1 naming convention
tidyConsump15$Governorates <- c("gouvernorat de tunis", "gouvernorat de ben arous", "gouvernorat de la manouba", "gouvernorat de nabeul", "gouvernorat de zaghouan", "gouvernorat de bizerte", "gouvernorat de beja","gouvernorat de jendouba","gouvernorat de kef","gouvernorat de siliana","gouvernorat de sousse","gouvernorat de monastir","gouvernorat de mahdia","gouvernorat de sfax","gouvernorat de kairouan","gouvernorat de kasserine","gouvernorat de sidi bou zid", "gouvernorat de gabes","gouvernorat de medenine","gouvernorat de tataouine","gouvernorat de gafsa","gouvernorat de tozeur","gouvernorat de kebili")

as.numeric(as.character(exitDF$immigrant))

df = data.frame(region=tidyConsump15$Governorates, value=as.numeric(as.character(tidyConsump15$Consumption)))

admin1_region_choropleth(df) 

```

### (4.b) "[Namson] scatter plot lowess"

### (4.c) A closer at outliers: Sfax
```{r}
lum_del <- read_csv("../data/intermediate/tun_lum_delegation_93_13.csv")
tbl_df(lum_del)
```

```{r}
del_sfax <- filter(lum_del,lum_del$NAME_1 == "Sfax")
tbl_df(del_sfax)
boxplot(del_sfax$`1992_mean`, horizontal = TRUE)
stripchart(del_sfax$`1992_mean`, col = "blue", pch = 21, add = TRUE, method = "jitter")
```
```{r}
ggplot(del_sfax, aes(del_sfax$NAME_2, del_sfax$`1992_mean`)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.2, width = 0.1, color = "#926d25") +
  coord_flip() +labs(y = "Luminosity (mean)", x = "Sfax delegation") +
  ggtitle("What is wrong with Sfax?",
          subtitle = "A closer look at luminosity by delegations within Sfax") +
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35"))
```


## (5) Executive summary (Presentation-style)

## (6) Interactive component

## (7) Conclusion

- Interested in looking at 2011 (year of the jasmine revolution) sicne the GDP went drastically down (Maybe less economic activity? Look into lumnisity?)
- Time series of luminosity per governorate
- !! Make a comment about coastal governorates
- https://academic.oup.com/eurpub/article/24/suppl_1/6/560448 - info on Choucha refugee crisis and 20% increase in Medeneine population
- Challenge: choroplethr naming for governorates is very specific and does not support french accent”. Two regions are missing.
- Bin side - looked into curtomizing it but very time consuming 
