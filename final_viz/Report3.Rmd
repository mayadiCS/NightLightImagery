---
title: "Report1"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(readxl)
library(here)
library(zoo)
library(reshape2)
library(scales)
source(here("data_cleaning", "clean_linkage.R"))
```

## (1) Introduction
- map of tunisia
- star wars
- hannibal
- colesium
- lack of usage of alternative data in the developing world

## (2) Description of data

- Linkage data was collected from INS website
- INS website is very slow
- Planet didn’t provide large enough coverage eg. at the country level
- Many sources for satellite imagery


## (3) Analysis of data quality

Some of the variable names are unclear, probably due to shoddy translation (i.e. what is the diff between ‘Number of households having drinking water from the public source or source of water association’ and ‘Number of households having drinking water from the other public or private source’?
- translation
- stata

## (4) Main analysis (Exploratory Data Analysis)

Extensive data processing

### (4.a) A First Look at Tunisia

```{r message = FALSE, warning = FALSE}
density <- readxl::read_xlsx("../data/intermediate/density.xlsx")
library(choroplethrAdmin1)
library(choroplethr)
admin1_choropleth("tunisia", density, num_colors = 7, title = "Population Density", legend = "Population Density (km\u00b2)") +
  ggtitle("Tunisia's Population Density by Governorate",
          subtitle = "Year: 2014") +
  labs(caption = "Source: L'Institut National de la Statistique (INS)") +
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35")) +
  theme(plot.caption = element_text(color = "grey68"))

```

Tunisia’s population is heavily concentrated on the coast and near the capital city of Tunis in particular, while the larger inland regions are very sparsely populated. It is likely that indictors of economic activity as well as measures of luminosity will be heavily concentrated around Tunis and the rest of the coast.

Note that the governorates of Ariana and Manouba north of Tunis are combined in the choroplethrAdmin1 package, so all choroplethr plots of Tunisia on the governorate level will show Ariana and Manouba as a combined governorate.

### (4.b) Population breakdown by Industry and Gender

```{r message = FALSE, warning = FALSE}
# household / population data
house_pop <- read_csv(here("data/intermediate",
                                "master_file.csv")) %>% 
  rename(Region = governorate)

occupation <- read_tun_data(here("data/raw", 
                                 "Distribution of the occupied population aged 15 years and over by the activity sector 11_18_2018 02_45_07.xlsx")) %>% 
  mutate(Region = str_replace(Region, "Governorate of ", "")) %>% # Standardize governorate names
  filter(Region != "Tunisia")


occupation <- occupation %>% 
  mutate_at(vars(contains("_")), function(x) as.numeric(x) / house_pop$over_15_population) %>% 
  select(-ends_with("Total"))

occupation <- occupation %>%
  gather(contains("_"), key="key", value="value") %>% 
  separate(key, into=c("sector", "gender"), sep="_") %>% 
  spread(sector, value)

```

```{r, fig.width=13, message = FALSE, warning = FALSE}
library(GGally)
# add y label - percent of total pop over 15 employed
occ_names <- c("Region", "gender", "Agr./Fishing", "Pub. Works", "Education/Health/Admin", "Manufacturing", "Mines/Energy", 
          "Other Serv.", "Trade", "Transport", "Undeclares")
names(occupation) <- occ_names
ggparcoord(occupation, columns = 3:11, alphaLines = .5,
           scale = "uniminmax", splineFactor = 10, groupColumn = 2) + 
  geom_vline(xintercept = 2:9, color = "lightblue") +
    ggtitle("Gender Disparity by Industry",
          subtitle = "Year: 2014") +
  labs(x = "Industry", y= "Percent employed", caption = "Source: L'Institut National de la Statistique (INS)") +
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35")) +
  theme(plot.caption = element_text(color = "grey68"))
```

Comments:
- interesting peak for mines/energy and manufactoring

### (4.c) Consumption by Governorates

TODO:
- add after map bar plot or cleveland dot plot to show ranking of governorates by consumption


```{r message = FALSE, warning = FALSE}
consumption2015 <- readxl::read_xlsx("../data/intermediate/Enquête Consommation 2010 12_08_2018 10_49_06.xlsx")

names(consumption2015) <- consumption2015[1,] #copy 1st row
consumption2015 <- consumption2015[-1,] #remove 1st row from df

names(consumption2015)[1]<-"categories"

totalConsump15 <- filter(consumption2015, consumption2015$categories == "Total")
tidyConsump15 <- gather(totalConsump15, key="Governorates", value="Consumption")
tidyConsump15 <- tidyConsump15[-1,]
#tidyConsump15 <- filter(tidyConsump15, tidyConsump15$Governorates == "Total")

#removing Greater regions
tidyConsump15 <- filter(tidyConsump15, !Governorates %in% c("Great Tunis", "Governorate of Ariana", "North East", "North West","Par grandes régions\\Centre Est","Par grandes régions\\Centre Ouest","Par grandes régions\\Sud Est","Par grandes régions\\Sud Ouest"))

#Note: Choroplethr does not include the governorate, "Governorate of Ariana" 

#Rename governorate to match the ChoroplethrAdmin1 naming convention
tidyConsump15$Governorates <- c("gouvernorat de tunis", "gouvernorat de ben arous", "gouvernorat de la manouba", "gouvernorat de nabeul", "gouvernorat de zaghouan", "gouvernorat de bizerte", "gouvernorat de beja","gouvernorat de jendouba","gouvernorat de kef","gouvernorat de siliana","gouvernorat de sousse","gouvernorat de monastir","gouvernorat de mahdia","gouvernorat de sfax","gouvernorat de kairouan","gouvernorat de kasserine","gouvernorat de sidi bou zid", "gouvernorat de gabes","gouvernorat de medenine","gouvernorat de tataouine","gouvernorat de gafsa","gouvernorat de tozeur","gouvernorat de kebili")

#as.numeric(as.character(exitDF$immigrant))

df = data.frame(region=tidyConsump15$Governorates, value=as.numeric(as.character(tidyConsump15$Consumption)))

admin1_region_choropleth(df, legend = "Consumption by Tunisian Dinar (TND)") +
  ggtitle("Consumption by Governorate",
          subtitle = "Year: 2015") +
  labs(caption = "Source: L'Institut National de la Statistique (INS)") +
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35")) +
  theme(plot.caption = element_text(color = "grey68"))

```

Comments:
- definie consumption
- can include excat categories that made up total
- per capital
- first comma from the right is delignating cents
- show top 5
- focus on sfax



### (4.d) Luminosity trends across Tunisia
```{r message = FALSE, warning = FALSE}
dataset <- readxl::read_xlsx("../data/intermediate/dataset.xlsx")
library(ggrepel)

dataset$population <- dataset$population / 1000

ggplot(dataset, aes(population,mean)) + 
    geom_point(color = "blue", size = 3) + geom_smooth(method = "lm", se = TRUE) + geom_label_repel(aes(label = governorate),                                                                             box.padding   = 0.35,                                                                         point.padding = 0.5,                                                                      segment.color = 'grey50') +
  ggtitle("Luminosity Vs population by Governorates",
          subtitle = "Year: 2014") +
  labs(x= "Population (thousands)", y="Luminosity (watts/cm\u00b2)", caption = "Source: National Oceanic and Atmospheric Administration (NOAA)") +
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35")) +
  theme(plot.caption = element_text(color = "grey68"))

```

This scatter plot of mean luminosity (in watts/cm2) against population (in thousands) by governorate shows some interesting trends, especially for the two high-population governorates of Tunis and Sfax to the right of the graph. Overall with the loess smoother, we can see that as expected there is a general upward trend in that as population increases, luminosity also increases. However, Tunis is significantly above the trendline, suggesting that it has a extraordinarily high level of luminosity compared to its population (which is 1,056,247 million to be exact). This further reinforces the point that commercial activity in Tunisia is heavily concentrated in Tunis.

In contrast, Sfax (population 1,113,496) is sharply below the trendline. While Sfax is even more populous than Tunis, it has a significantly lower level of mean luminosity relative to population than the rest of Tunisia. This is a rather bizarre finding that merits further exploration. We decided to take a look at consumption per governorate to see if it could tell us anything about the outlier of Sfax.


```{r}
tidyConsump15$Consumption <- as.numeric(tidyConsump15$Consumption)/ 1000000
g <- ggplot(tidyConsump15, aes(x = Consumption, y = fct_reorder(Governorates, Consumption))) +
    geom_point(color = "blue") + ylab("") +
  ggtitle("Consumption by Governorate",
          subtitle = "Year: 2015") +
  labs(x = "Consumption (millions)", caption = "Source: L'Institut National de la Statistique (INS)") +
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35")) +
  theme(plot.caption = element_text(color = "grey68"))
g
```

Comments:
- note sfax is part of top 5 but is a clear outlier in the lowess plot

### (4.e) A closer at outliers: Sfax
```{r message = FALSE, warning = FALSE}
lum_del <- read_csv("../data/intermediate/tun_lum_delegation_93_13.csv")

del_sfax <- filter(lum_del,lum_del$NAME_1 == "Sfax")
boxplot(del_sfax$`2013_mean`, horizontal = TRUE, main = "Luminosity of Sfax Delegations (Year: 2013)", xlab = "Luminosity (watts/cm\u00b2)")
stripchart(del_sfax$`2013_mean`, col = "blue", pch = 21, add = TRUE, method = "jitter")
```

```{r}
ggplot(del_sfax, aes(del_sfax$NAME_2, del_sfax$`1992_mean`)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.2, width = 0.1, color = "#926d25") +
  coord_flip() +labs(y = "Luminosity (mean)", x = "Sfax delegation") +
  ggtitle("Which are the leading delegations within Sfax?",
          subtitle = "A closer look at luminosity by delegations within Sfax") +
  labs(x= "Sfax Delegations", y="Luminosity (watts/cm\u00b2)", caption = "Source: National Oceanic and Atmospheric Administration (NOAA)") +
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35")) +
  theme(plot.caption = element_text(color = "grey68"))
```

Comments:
- Clear unbalance between delegations within the Sfax governorates. The outliers are: xxx and YYY.


What might explain such variation in luminosity?
- a little more

### (4.f) Exploring potential covariates of luminosity

```{r message = FALSE, warning = FALSE}
# appliance data
  
appliances <- read_tun_data(here("data/raw", 
                                 "Households by possession of electrical household equipements 11_18_2018 02_51_51.xlsx")) %>% 
  mutate(Region = str_replace(Region, "Governorate of ", "")) %>% # Standardize governorate names
  filter(Region != "Tunisia")
    

# household / population data
house_pop <- read_csv(here("data/intermediate",
                                "master_file.csv")) %>% 
  rename(Region = governorate)

appliances <- inner_join(select(house_pop, Region, households), appliances)
```

```{r}
# tidy
appliances <- appliances %>%
  gather(contains("_"), key="key", value="value") %>% 
  separate(key, into=c("Appliance", "Measure"), sep="_") %>% 
  spread(Appliance, value)

# we only want total
appliances_total <- appliances %>%
  filter(Measure == "Total") %>% 
  select(-Measure)

#fix the names
ap_names = c("Region", "households", "AC", "heat", "dishwasher", "stove", "fridge", "washing_machine")
names(appliances_total) <- ap_names

# cleaning up
appliances_total <- appliances_total %>% 
  mutate_at(.vars = vars(-Region), funs(as.numeric)) %>% 
  mutate(Region = str_replace(Region, "Governorate of ", "")) 


```


```{r, fig.height=10}
appliances_tidy <- appliances_total %>% 
  gather(-Region, -households, key="appliances_type", value="num_appliances") %>% 
  mutate(appliances_household = num_appliances / households)

g_stacked <- ggplot(appliances_tidy, aes(y = appliances_household,
                                  x = fct_reorder2(Region, appliances_type, -appliances_household),
                                  fill = appliances_type)) +
    coord_flip() +
    geom_bar(stat="identity") + ylab("") +
    ggtitle("Appliances Resources per Household",
          subtitle = "Year: 2014") +
  labs(x = "Number of Appliances per Household", y= "Governorates", caption = "Source: L'Institut National de la Statistique (INS)") +
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35")) +
  theme(plot.caption = element_text(color = "grey68"))

g_stacked
```

```{r message = FALSE, warning = FALSE}
internet <- read_tun_data(here("data/raw", 
                                 "Households by possession of ICTs 11_18_2018 02_51_58.xlsx")) %>% 
  mutate(Region = str_replace(Region, "Governorate of ", "")) %>% # Standardize governorate names
  filter(Region != "Tunisia") %>% 
  select(-contains("households_"))

internet <- inner_join(select(house_pop, Region, households), internet)
```

```{r}
# tidy
internet <- internet %>%
  gather(contains("_"), key="key", value="value") %>% 
  separate(key, into=c("Appliance", "Measure"), sep="_") %>% 
  spread(Appliance, value)

# we only want total
internet_total <- internet %>%
  filter(Measure == "Total") %>% 
  select(-Measure)

#fix the names
internet_names = c("Region", "households", "computer", "landline", "internet", "mobile")
names(internet_total) <- internet_names

# cleaning up
internet_total <- internet_total %>% 
  mutate_at(.vars = vars(-Region), funs(as.numeric)) %>% 
  mutate(Region = str_replace(Region, "Governorate of ", "")) 

```


```{r, fig.height=10}
#graph it

internet_tidy <- internet_total %>% 
  gather(-Region, -households, key="ict_type", value="num_ict") %>% 
  mutate(ict_household = num_ict / households)

g_stacked <- ggplot(internet_tidy, aes(y = ict_household,
                                  x = fct_reorder2(Region, ict_type, -ict_household),
                                  fill = ict_type)) +
    coord_flip() +
    geom_bar(stat="identity") + ylab("") +
    ggtitle("Information and Communications Technology (ICT) Resources per Household",
          subtitle = "Year: 2014") +
  labs(x = "Number of Appliances per Household", y= "Governorates", caption = "Source: L'Institut National de la Statistique (INS)") +
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35")) +
  theme(plot.caption = element_text(color = "grey68"))

g_stacked
```

# Leisure Resources
```{r message = FALSE, warning = FALSE}
leisure <- read_tun_data(here("data/raw", 
                                 "Households by possession of leisure resources 11_18_2018 02_51_43.xlsx")) %>% 
  mutate(Region = str_replace(Region, "Governorate of ", "")) %>% # Standardize governorate names
  filter(Region != "Tunisia") %>% 
  select(-contains("households_"))

leisure <- inner_join(select(house_pop, Region, households), leisure)

# tidy
leisure <- leisure %>%
  gather(contains("_"), key="key", value="value") %>% 
  separate(key, into=c("Appliance", "Measure"), sep="_") %>% 
  spread(Appliance, value)

# we only want total
leisure_total <- leisure %>%
  filter(Measure == "Total") %>% 
  select(-Measure)

#fix the names
leisure_names = c("Region", "households", "car", "library", "dish", "radio", "TV")
names(leisure_total) <- leisure_names

# cleaning up
leisure_total <- leisure_total %>% select("Region", "households", "car", "dish", "radio", "TV") %>%
  mutate_at(.vars = vars(-Region), funs(as.numeric)) %>% 
  mutate(Region = str_replace(Region, "Governorate of ", "")) 


```

```{r, fig.height=10}
leisure_tidy <- leisure_total %>% 
  gather(-Region, -households, key="leisure_type", value="num_leisure") %>% 
  mutate(leisure_household = num_leisure / households)

g_stacked <- ggplot(leisure_tidy, aes(y = leisure_household,
                                  x = fct_reorder2(Region, leisure_type, -leisure_household),
                                  fill = leisure_type)) +
    coord_flip() +
    geom_bar(stat="identity") + ylab("") +
    ggtitle("Leisure Resources per Household",
          subtitle = "Year: 2014") +
  labs(x = "Leisure Resources per Household", y= "Governorates", caption = "Source: L'Institut National de la Statistique (INS)") +
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35")) +
  theme(plot.caption = element_text(color = "grey68"))

g_stacked

```

Finally, we take a look at how luminosity has changed over time in order to gleam insights about how they may reveal changes in Tunisia economic activity throughout the years. Note that we previously could not look at how luminosity compared to governorate-level economic indicators such as household appliances, leisure resources, and consumption over time because of data limitations, namely that those metrics have not been been consistently measured throughout the years in Tunisia. 

```{r message = FALSE, warning = FALSE}
lum <- read_csv("../data/final/tun_lum_governorate_93_13_tidy.csv")

# Plot of Luminosity by Governorate by Year
ggplot(lum, aes(x = year, y = mean, colour=NAME_1)) +
geom_line() +
xlab("Year") +
ylab("Luminosity (watts/cm\u00b2)") +
labs(color='Governorate', caption = "Source: L'Institut National de la Statistique (INS)") +
    ggtitle("Luminosity by Governorate by Year",
          subtitle = "1992 - 2013") +
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35")) +
  theme(plot.caption = element_text(color = "grey68"))
```

This plot of luminosity by governorate by year shows that Tunis has had a significantly higher level of luminosity than the other governorates. The three governorates in the middle of the graph (Ariana, Ben Arous, and Monastir) are suburban extensions of Tunis. The rest of the governorates are bunched together at the bottom of the plot. In general there is an upward trend in luminosity from 1992 to 2013, but it is not consistent from year to year, as there are peaks and valleys that show that the increase in light is not linear. For an additional frame of reference, see the appendix for an illustrative example of a few governorates with high, medium, and low levels of luminosity from 1992 to 2013.

Of particular interest is the sharp downward spike in luminosity for every governorate from 2010 to 2011. 2011 is the year of the Tunisian Revolution, and it is very possible that the political and economic turmoil of that revolution caused luminosity in Tunisia to crash for that particular year.


```{r message = FALSE, warning = FALSE}
tun <- lum %>% 
   group_by(year) %>%                         
   summarise(count = sum(count), sum = sum(sum))
   
tunisia_economy <- read_csv("../data/intermediate/tunisia_economy.csv")
tunisia <- merge(tun,tunisia_economy,by="year")

tunisia$avg_lum <- tunisia$sum / tunisia$count

melt_tunisia <- melt(tunisia,id="year")

melt_tunisia <- melt_tunisia %>%
      group_by(variable) %>%
      arrange(year) %>%
      mutate(indexedvalue = 100 * value / first(value))

ggplot(subset(melt_tunisia, variable %in% c("avg_lum", "govt_debt", "gdp_per_capita", "gdp_growth", "inflation", "unemployment_rate")),
       aes(x=year,
       y=indexedvalue,
       color=variable, group = variable))+
  geom_line() + ggtitle("Indexed Economic Indicators for Tunisia", subtitle = "1992 - 2013") +xlab("Year") + ylab("Indexed Value") + labs(color='Variable', caption = "Source: L'Institut National de la Statistique (INS)") + 
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35")) +
  theme(plot.caption = element_text(color = "grey68"))
```  

This plot further explores the connection between luminosity and Tunisian economic indicators from 1992 to 2013, but this time on a national level. Note that each variable is indexed to the value from the base year of 1992 and at the starting value of 100. 

The variable ‘avg_lum’ in this plot is the average level of luminosity in watts/cm2 for the entire country of Tunisia from 1992 to 2013. This is calculated by summing up the total sum of pixel values of luminosity for all of the governorates as well the total count of the number of pixels for each governorate (which is essentially a static number of the amount of pixels that comprise a given land area) for all of Tunisia, then dividing the total sum by the total count for each year from 1992 to 2013. 

As we have noted before, while there is a general upward trend in luminosity from 1992 to 2013, it is not consistent from year to year. In contrast GDP per capita has increased every single year since 1992 with the exception of 2011. In 2011, both GDP growth and GDP per capita sharply fall, while luminosity, inflation, the unemployment rate, and government debt all increase to varying degrees. Overall 2011 was a very bad year for Tunisia economically. 

However in this graph it is difficult to ascertain a particular relationship between luminosity and other economic indicators. Because of this we decided to perform a correlation test to see how correlated the level of luminosity in Tunisia was to the other variables.


```{r}
cor_tunisia <- cor(tunisia)
cor_tunisia
```

The correlation of luminosity with total GDP is 0.75 and with GDP per capita is 0.74, which suggests that luminosity can be a fairly strong proxy of measures of GDP. While there is little correlation with measures of inflation (0.14) and unemployment rate (-0.11), they are at least in the direction that we expect – both higher levels of inflation and luminosity would suggest greater levels of economic activity, while unemployment rates would likely have a negative relationship with luminosity, as high levels of unemployment suggest the economy is not doing well and that there is less light to be observed in a given year.

Of particular interest is that the relationship between luminosity and government debt is very strong in the negative direction (-0.66). A possible explanation for this is that higher levels of government debt are associated with the economy not doing well, and thus there is less luminosity to be observed.

```{r}
ggplot(data = tunisia, mapping = aes(x = year)) + 
  geom_line(aes(y = scales::rescale(avg_lum)), color = "blue", size = 1.5, alpha = .5) + 
  geom_line(aes(y = scales::rescale(gdp_ppp)), color = "yellow", size = 1.5, alpha = .5) +
              theme(legend.position=c(.1,.85)) +
    ggtitle("Luminosity vs. GDP per capita (PPP) in Tunisia (Normalized)",
          subtitle = "1992 - 2013") +
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35")) +
  theme(plot.caption = element_text(color = "grey68")) + xlab("Year") +ylab("Normalized Value")
```

This graph shows the normalized relationship between the level of luminosity and GDP per capita PPP in Tunisia from 1992 to 2013. While the correlation between the two measures is 0.74 and both show an overall upward trend during the given time interval, we can see that GDP per capita (PPP) is a relatively stable measure, while the level of luminosity wildly fluctuates from year to year. This suggests that GDP per capita is a more reliable measure of economic activity compared to the level of luminosity. 

```{r}
ggplot(data = tunisia, mapping = aes(x = year)) + 
  geom_line(aes(y = scales::rescale(avg_lum)), color = "blue", size = 1.5, alpha = .5) + 
  geom_line(aes(y = scales::rescale(gdp_growth)), color = "green", size = 1.5, alpha = .5) +
              theme(legend.position=c(.1,.85))	+
    ggtitle("Luminosity vs. GDP Growth in Tunisia (Normalized)",
          subtitle = "1992 - 2013") +
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35")) +
  theme(plot.caption = element_text(color = "grey68")) + xlab("Year") +ylab("Normalized Value")
```

Recall that luminosity and GDP growth have a slightly negative relationship (-0.38). This may provide some evidence for the theory of economic convergence, namely that poorer regions (that we assume to be lower in luminosity) grow at faster rates than more developed regions. This graph of the relationship between the two variables shows that when normalized luminosity is low, normalized gdp growth tends to be high and vice versa; observe the time ranges of 1995-2000, 2003 to 2008, and 2011-2013 to see this trend.

```{r}
ggplot(data = tunisia, mapping = aes(x = year)) + 
  geom_line(aes(y = rescale(avg_lum)), color = "blue", size = 1.5, alpha = .5) + 
  geom_line(aes(y = rescale(govt_debt)), color = "red", size = 1.5, alpha = .5) +
              theme(legend.position=c(.1,.85))	 +
    ggtitle("Luminosity vs. Government Debt in Tunisia (Normalized)",
          subtitle = "1992 - 2013") +
  theme(plot.title = element_text(face = "bold")) +
  theme(plot.subtitle = element_text(face = "bold", color = "grey35")) +
  theme(plot.caption = element_text(color = "grey68")) + xlab("Year") +ylab("Normalized Value")			  
	         
```

Finally, the negative relationship between government debt and luminosity can be seen in this graph. From 1992 to 2000, normalized government debt is high while normalized luminosity is low. From 2000 onwards, government debt begins to steadily decrease until 2011 when it sharply spikes again. Luminosity generally seems to climb over this timespan, but again in a very non-linear way. Overall, it is clear from these graphs that even as luminosity generally increases over time, it fluctuates wildly from year to year, much more so than other, more official economic indicators that are measured across time.


 
## (5) Executive summary (Presentation-style)

## (6) Interactive component

## (7) Conclusion

- Interested in looking at 2011 (year of the jasmine revolution) sicne the GDP went drastically down (Maybe less economic activity? Look into lumnisity?)
- Time series of luminosity per governorate
- !! Make a comment about coastal governorates
- https://academic.oup.com/eurpub/article/24/suppl_1/6/560448 - info on Choucha refugee crisis and 20% increase in Medeneine population
- Challenge: choroplethr naming for governorates is very specific and does not support french accent”. Two regions are missing.
- Bin side - looked into curtomizing it but very time consuming 


## Appendix

```{r, fig.height=10}
g_dot_facet <- ggplot(appliances_tidy, aes(x = appliances_household,
                                  y = reorder(Region, appliances_household))) + 
    geom_point() + ylab("") +
    ggtitle("appliances Resources per Household")

g_dot_facet + facet_wrap(~appliances_type, ncol=1)
```

```{r, fig.height=10}
g_dot_facet <- ggplot(internet_tidy, aes(x = ict_household,
                                  y = reorder(Region, ict_household))) + 
    geom_point() + ylab("") +
    ggtitle("internet Resources per Household")

g_dot_facet + facet_wrap(~ict_type, ncol=1)
```

```{r, fig.height=10}
g_dot_facet <- ggplot(leisure_tidy, aes(x = leisure_household,
                                  y = reorder(Region, leisure_household))) + 
    geom_point() + ylab("") +
    ggtitle("Leisure Resources per Household")

g_dot_facet + facet_wrap(~leisure_type, ncol=1)
```

```{r}
# Subset of Data
ggplot(subset(lum, NAME_1 %in% c("Tunis", "Sfax", "Monastir", "Tataouine")),
       aes(x=year,
       y=mean,
       color=NAME_1, group = NAME_1))+
  geom_line() +
ylab("Luminosity") +
ggtitle("Luminosity of Four Governorates by Year") + labs(color='Governorate') 
```